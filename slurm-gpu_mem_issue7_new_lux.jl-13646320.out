This software collection is provided and supported by CSC.
Run `module help Local-CSC` for more information about support.
Not all software may be compatible with software in other stacks,
so mix at your own risk. 

Due to MODULEPATH changes, the following have been reloaded:
  1) rocm/6.0.3

The following have been reloaded with a version change:
  1) julia/1.12.0 => julia/1.11.3

This software collection is provided and supported by CSC.
Run `module help Local-CSC` for more information about support.
Not all software may be compatible with software in other stacks,
so mix at your own risk. 

The following have been reloaded with a version change:
  1) julia/1.11.3 => julia/1.12.0

SLURM_JOB_NAME: gpu_mem_issue7_new_luc.jl
SLURM_JOB_NODELIST: nid005043
ROCR_VISIBLE_DEVICES: 0
julia: /appl/local/csc/soft/math/julia/1.12.0/bin/julia
arguments: gpu_mem_issue7.jl
Precompiling packages...
 110073.7 ms  âœ“ Functors
 106500.4 ms  âœ“ Static
   1153.7 ms  âœ“ ArrayInterface â†’ ArrayInterfaceChainRulesCoreExt
  40622.9 ms  âœ“ StaticArrayInterface
   1670.6 ms  âœ“ ComponentArrays
  5 dependencies successfully precompiled in 183 seconds. 20 already precompiled.
Precompiling packages...
    938.4 ms  âœ“ StaticArrayInterface â†’ StaticArrayInterfaceStaticArraysExt
  1 dependency successfully precompiled in 6 seconds. 21 already precompiled.
Precompiling packages...
    665.4 ms  âœ“ StaticArrayInterface â†’ StaticArrayInterfaceOffsetArraysExt
  1 dependency successfully precompiled in 1 seconds. 19 already precompiled.
Precompiling packages...
   1457.5 ms  âœ“ ChunkCodecLibZlib
    794.8 ms  âœ“ ChunkCodecLibZstd
 223409.6 ms  âœ“ JLD2
  3 dependencies successfully precompiled in 236 seconds. 37 already precompiled.
Precompiling packages...
   2222.8 ms  âœ“ CPUSummary
   3485.9 ms  âœ“ DispatchDoctor
   2675.5 ms  âœ“ Optimisers
   2086.3 ms  âœ“ MLDataDevices
   7659.1 ms  âœ“ WeightInitializers
   9393.4 ms  âœ“ KernelAbstractions
   1801.4 ms  âœ“ LuxCore
   1243.2 ms  âœ“ DispatchDoctor â†’ DispatchDoctorEnzymeCoreExt
   1567.9 ms  âœ“ DispatchDoctor â†’ DispatchDoctorChainRulesCoreExt
   1504.9 ms  âœ“ Optimisers â†’ OptimisersEnzymeCoreExt
   9092.8 ms  âœ“ ForwardDiff
   1209.1 ms  âœ“ Optimisers â†’ OptimisersAdaptExt
   1406.6 ms  âœ“ MLDataDevices â†’ MLDataDevicesChainRulesCoreExt
   1643.0 ms  âœ“ WeightInitializers â†’ WeightInitializersChainRulesCoreExt
   2251.4 ms  âœ“ KernelAbstractions â†’ LinearAlgebraExt
   1906.5 ms  âœ“ KernelAbstractions â†’ EnzymeExt
   1327.2 ms  âœ“ LuxCore â†’ LuxCoreChainRulesCoreExt
   1122.4 ms  âœ“ LuxCore â†’ LuxCoreFunctorsExt
   1104.2 ms  âœ“ LuxCore â†’ LuxCoreEnzymeCoreExt
   1202.5 ms  âœ“ LuxCore â†’ LuxCoreSetfieldExt
   1477.5 ms  âœ“ LuxCore â†’ LuxCoreMLDataDevicesExt
   2635.2 ms  âœ“ ForwardDiff â†’ ForwardDiffStaticArraysExt
   7498.5 ms  âœ“ NNlib
   2020.5 ms  âœ“ NNlib â†’ NNlibSpecialFunctionsExt
   2191.7 ms  âœ“ NNlib â†’ NNlibEnzymeCoreExt
   1168.9 ms  âœ“ NNlib â†’ NNlibForwardDiffExt
   8336.1 ms  âœ“ LuxLib
  26892.1 ms  âœ“ Lux
  28 dependencies successfully precompiled in 101 seconds. 71 already precompiled.
Precompiling packages...
   1921.1 ms  âœ“ ComponentArrays â†’ ComponentArraysKernelAbstractionsExt
  1 dependency successfully precompiled in 4 seconds. 40 already precompiled.
Precompiling packages...
   1532.1 ms  âœ“ KernelAbstractions â†’ SparseArraysExt
  1 dependency successfully precompiled in 2 seconds. 29 already precompiled.
Precompiling packages...
   1013.5 ms  âœ“ ComponentArrays â†’ ComponentArraysOptimisersExt
  1 dependency successfully precompiled in 3 seconds. 28 already precompiled.
Precompiling packages...
    834.7 ms  âœ“ MLDataDevices â†’ MLDataDevicesSparseArraysExt
  1 dependency successfully precompiled in 1 seconds. 19 already precompiled.
Precompiling packages...
    641.1 ms  âœ“ MLDataDevices â†’ MLDataDevicesFillArraysExt
  1 dependency successfully precompiled in 1 seconds. 16 already precompiled.
Precompiling packages...
   1031.6 ms  âœ“ MLDataDevices â†’ MLDataDevicesComponentArraysExt
  1 dependency successfully precompiled in 1 seconds. 27 already precompiled.
Precompiling packages...
   1713.6 ms  âœ“ Lux â†’ LuxComponentArraysExt
  1 dependency successfully precompiled in 3 seconds. 105 already precompiled.
Precompiling packages...
   2039.8 ms  âœ“ BangBang
   1564.2 ms  âœ“ SimpleTraits
   6061.5 ms  âœ“ StatsBase
   2433.4 ms  âœ“ SplittablesBase
   1291.1 ms  âœ“ BangBang â†’ BangBangChainRulesCoreExt
   1514.1 ms  âœ“ BangBang â†’ BangBangStaticArraysExt
   1175.1 ms  âœ“ BangBang â†’ BangBangTablesExt
   1866.8 ms  âœ“ MicroCollections
   2689.9 ms  âœ“ MLCore
   5219.9 ms  âœ“ Transducers
   1678.2 ms  âœ“ Transducers â†’ TransducersAdaptExt
   5163.0 ms  âœ“ FLoops
   8921.9 ms  âœ“ MLUtils
  13 dependencies successfully precompiled in 46 seconds. 86 already precompiled.
Precompiling packages...
   1830.1 ms  âœ“ MLDataDevices â†’ MLDataDevicesMLUtilsExt
  1 dependency successfully precompiled in 3 seconds. 104 already precompiled.
Precompiling packages...
   2222.7 ms  âœ“ Lux â†’ LuxMLUtilsExt
  1 dependency successfully precompiled in 4 seconds. 158 already precompiled.
Precompiling packages...
   2132.9 ms  âœ“ ZygoteRules
   8370.3 ms  âœ“ ChainRules
  52659.7 ms  âœ“ Zygote
  3 dependencies successfully precompiled in 66 seconds. 64 already precompiled.
Precompiling packages...
    677.1 ms  âœ“ Accessors â†’ StructArraysExt
  1 dependency successfully precompiled in 1 seconds. 20 already precompiled.
Precompiling packages...
    706.2 ms  âœ“ BangBang â†’ BangBangStructArraysExt
  1 dependency successfully precompiled in 1 seconds. 24 already precompiled.
Precompiling packages...
    865.5 ms  âœ“ StructArrays â†’ StructArraysStaticArraysExt
  1 dependency successfully precompiled in 1 seconds. 19 already precompiled.
Precompiling packages...
    977.8 ms  âœ“ StructArrays â†’ StructArraysGPUArraysCoreExt
  1 dependency successfully precompiled in 1 seconds. 36 already precompiled.
Precompiling packages...
    982.8 ms  âœ“ ArrayInterface â†’ ArrayInterfaceChainRulesExt
  1 dependency successfully precompiled in 1 seconds. 40 already precompiled.
Precompiling packages...
   1007.6 ms  âœ“ MLDataDevices â†’ MLDataDevicesChainRulesExt
  1 dependency successfully precompiled in 1 seconds. 42 already precompiled.
Precompiling packages...
   1952.3 ms  âœ“ ComponentArrays â†’ ComponentArraysZygoteExt
  1 dependency successfully precompiled in 4 seconds. 80 already precompiled.
Precompiling packages...
   1659.7 ms  âœ“ MLDataDevices â†’ MLDataDevicesZygoteExt
  1 dependency successfully precompiled in 2 seconds. 74 already precompiled.
Precompiling packages...
   3484.1 ms  âœ“ Lux â†’ LuxZygoteExt
  1 dependency successfully precompiled in 4 seconds. 137 already precompiled.
Precompiling packages...
   6094.4 ms  âœ“ AcceleratedKernels
   8354.9 ms  âœ“ GPUArrays
  33910.8 ms  âœ“ AMDGPU
  3 dependencies successfully precompiled in 61 seconds. 89 already precompiled.
Precompiling packages...
Info Given ComponentArraysGPUArraysExt was explicitly requested, output will be shown live [0K
[0KWARNING: Constructor for type "ComponentArray" was extended in `ComponentArraysGPUArraysExt` without explicit qualification or import.
[0K  NOTE: Assumed "ComponentArray" refers to `ComponentArrays.ComponentArray`. This behavior is deprecated and may differ in future versions.`
[0K  NOTE: This behavior may have differed in Julia versions prior to 1.12.
[0K  Hint: If you intended to create a new generic function of the same name, use `function ComponentArray end`.
[0K  Hint: To silence the warning, qualify `ComponentArray` as `ComponentArrays.ComponentArray` in the method signature or explicitly `import ComponentArrays: ComponentArray`.
   2278.3 ms  âœ“ ComponentArrays â†’ ComponentArraysGPUArraysExt
  1 dependency successfully precompiled in 3 seconds. 72 already precompiled.
  1 dependency had output during precompilation:
â”Œ ComponentArrays â†’ ComponentArraysGPUArraysExt
â”‚  [Output was shown above]
â””  
Precompiling packages...
   1854.3 ms  âœ“ MLDataDevices â†’ MLDataDevicesGPUArraysExt
  1 dependency successfully precompiled in 8 seconds. 60 already precompiled.
Precompiling packages...
   1887.1 ms  âœ“ WeightInitializers â†’ WeightInitializersGPUArraysExt
  1 dependency successfully precompiled in 2 seconds. 62 already precompiled.
Precompiling packages...
   2125.0 ms  âœ“ GPUArrays â†’ JLD2Ext
  1 dependency successfully precompiled in 3 seconds. 60 already precompiled.
Precompiling packages...
   7360.0 ms  âœ“ AMDGPU â†’ AMDGPUChainRulesCoreExt
   8121.3 ms  âœ“ NNlib â†’ NNlibAMDGPUExt
  2 dependencies successfully precompiled in 9 seconds. 102 already precompiled.
Precompiling packages...
   3932.1 ms  âœ“ MLDataDevices â†’ MLDataDevicesAMDGPUExt
  1 dependency successfully precompiled in 5 seconds. 102 already precompiled.
Precompiling packages...
   3730.7 ms  âœ“ WeightInitializers â†’ WeightInitializersAMDGPUExt
  1 dependency successfully precompiled in 4 seconds. 95 already precompiled.
Precompiling packages...
   3818.8 ms  âœ“ AMDGPU â†’ AMDGPUEnzymeCoreExt
  1 dependency successfully precompiled in 4 seconds. 95 already precompiled.
AMDGPU.devices() = AMDGPU.HIP.HIPDevice[HIPDevice(id=1, name=AMD Instinct MI250X, gcn_arch=gfx90a:sramecc+:xnack-)]
[ Info: AMDGPU versioninfo
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ Available â”‚ Name             â”‚ Version   â”‚ Path                              â‹¯
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚     +     â”‚ LLD              â”‚ -         â”‚ /opt/rocm-6.0.3/lib/llvm/bin/ld.l â‹¯
â”‚     +     â”‚ Device Libraries â”‚ -         â”‚ /users/barthale/.julia/artifacts/ â‹¯
â”‚     +     â”‚ HIP              â”‚ 6.0.32831 â”‚ /opt/rocm-6.0.3/lib/libamdhip64.s â‹¯
â”‚     +     â”‚ rocBLAS          â”‚ 4.0.0     â”‚ /opt/rocm-6.0.3/lib/librocblas.so â‹¯
â”‚     +     â”‚ rocSOLVER        â”‚ 3.24.0    â”‚ /opt/rocm-6.0.3/lib/librocsolver. â‹¯
â”‚     +     â”‚ rocSPARSE        â”‚ 3.0.2     â”‚ /opt/rocm-6.0.3/lib/librocsparse. â‹¯
â”‚     +     â”‚ rocRAND          â”‚ 2.10.5    â”‚ /opt/rocm-6.0.3/lib/librocrand.so â‹¯
â”‚     +     â”‚ rocFFT           â”‚ 1.0.25    â”‚ /opt/rocm-6.0.3/lib/librocfft.so  â‹¯
â”‚     +     â”‚ MIOpen           â”‚ 3.0.0     â”‚ /opt/rocm-6.0.3/lib/libMIOpen.so  â‹¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                                                                1 column omitted

[ Info: AMDGPU devices
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€
â”‚ Id â”‚                Name â”‚               GCN arch â”‚ Wavefront â”‚     Memory â”‚ â‹¯
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€
â”‚  1 â”‚ AMD Instinct MI250X â”‚ gfx90a:sramecc+:xnack- â”‚        64 â”‚ 63.984 GiB â”‚ â‹¯
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€
                                                                1 column omitted

parallel = false
output directory: /users/barthale/Data/Biscay/Results-fm/2025-10-17T182059
using 1 thread(s)
â”Œ Info: parameters
â”‚   nepochs = 1000
â”‚   batchsize = 128
â”‚   learning_rate = 0.0005
â”‚   channels = (64, 128, 256)
â”‚   activation = selu (generic function with 2 methods)
â””   nfrequencies = 3
outdir = "/users/barthale/Data/Biscay/Results-fm/2025-10-17T182059"
backend = nothing
(nn, lossval) = (1, 2.0090263f0)
(nn, lossval) = (2, 1.6517578f0)
(nn, lossval) = (3, 1.6128658f0)
(nn, lossval) = (4, 1.5996172f0)
(nn, lossval) = (5, 1.5972232f0)
(nn, lossval) = (6, 1.5835683f0)
(nn, lossval) = (7, 1.5814285f0)
(nn, lossval) = (8, 1.5749596f0)
(nn, lossval) = (9, 1.5712975f0)
(nn, lossval) = (10, 1.5667591f0)
:0:rocdevice.cpp            :2724: 377148849098 us: [pid:97988 tid:0x14d31dbff700] Callback: Queue 0x14d31aa00000 Aborting with error : HSA_STATUS_ERROR_OUT_OF_RESOURCES: The runtime failed to allocate the necessary resources. This error may also occur when the core runtime library needs to spawn threads or create internal OS-specific events. Code: 0x1008 Available Free mem : 0 MB

[97988] signal 6 (-6): Aborted
in expression starting at /pfs/lustrep4/users/barthale/.julia/dev/lumi-lux-mem-issues/gpu_mem_issue7.jl:393
Allocations: 690448124 (Pool: 690385601; Big: 62523); GC: 10045
srun: error: nid005043: task 0: Aborted
srun: Terminating StepId=13646320.0
